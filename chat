AzureDiagnostics
| where ResourceType == "KEYVAULTS"
| where OperationName == "GetSecret"
| where Status == "Forbidden"
| where TimeGenerated >= datetime(2024-05-01) and TimeGenerated <= datetime(2024-05-16)
| extend ADF_IP = extract(@"\d+\.\d+\.\d+\.\d+", 0, CallerIpAddress)
| project CallerIpAddress, ADF_IP
