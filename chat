AzureDiagnostics
| where ResourceProvider == "MICROSOFT.KEYVAULT" // Filter for Key Vault logs
| where OperationName == "GetSecret" // Filter for GetSecret operations
| where Category == "AuditEvent"
| where ResultType == "Failure" // Filter for failed attempts
| extend RequestedSecret = tostring(parse_json(ExtendedProperties).requestedSecret)
| extend CallerIPAddress = tostring(parse_json(ExtendedProperties).callerIPAddress)
| where RequestedSecret contains "<your_secret_name>" // Replace <your_secret_name> with the name of the secret
| join kind=inner (
    AzureDiagnostics
    | where ResourceProvider == "MICROSOFT.DATAFACTORY" // Filter for Data Factory logs
    | where OperationName == "ActivityPipelineRunStart"
    | project CallerIPAddress
) on CallerIPAddress
| project CallerIPAddress, ResultDescription, ActivityId, OperationName, TimeGenerated
