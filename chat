import logging
import azure.functions as func
from azure.storage.blob import BlobServiceClient

def main(blob: func.InputStream):
    logging.info(f"Processing blob: {blob.name} ({blob.length} bytes)")

    # Connection string to your Azure Storage account
    connection_string = "your_storage_account_connection_string"

    # Create a BlobServiceClient object
    blob_service_client = BlobServiceClient.from_connection_string(connection_string)

    # Destination container information
    destination_container_name = "destination-container"

    # Get the blob client for the destination blob
    destination_blob_client = blob_service_client.get_blob_client(
        container=destination_container_name,
        blob=blob.name
    )

    # Upload the blob data to the destination container directly using the input stream
    destination_blob_client.upload_blob(blob, overwrite=True)

    logging.info(f"Blob {blob.name} has been transferred to {destination_container_name} container.")



{
  "bindings": [
    {
      "name": "blob",
      "type": "blobTrigger",
      "direction": "in",
      "path": "source-container/{name}",
      "connection": "AzureWebJobsStorage"
    }
  ],
  "scriptFile": "__init__.py"
}
