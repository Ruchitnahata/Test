from azure.servicebus import ServiceBusClient, ServiceBusMessage

# Connection string to your Service Bus namespace
connection_str = 'YOUR_SERVICE_BUS_CONNECTION_STRING'
queue_name = 'YOUR_QUEUE_NAME'

# Create a ServiceBusClient using the connection string
servicebus_client = ServiceBusClient.from_connection_string(conn_str=connection_str, logging_enable=True)

# Create a sender for the queue
with servicebus_client:
    sender = servicebus_client.get_queue_sender(queue_name=queue_name)
    with sender:
        # Create a message
        message = ServiceBusMessage("Hello, Service Bus!")
        
        # Send the message
        sender.send_messages(message)
        print("Message sent successfully.")



from azure.servicebus import ServiceBusClient

# Connection string to your Service Bus namespace
connection_str = 'YOUR_SERVICE_BUS_CONNECTION_STRING'
queue_name = 'YOUR_QUEUE_NAME'

# Create a ServiceBusClient using the connection string
servicebus_client = ServiceBusClient.from_connection_string(conn_str=connection_str, logging_enable=True)

# Create a receiver for the queue
with servicebus_client:
    receiver = servicebus_client.get_queue_receiver(queue_name=queue_name)
    with receiver:
        # Receive a message from the queue
        received_messages = receiver.receive_messages(max_message_count=1, max_wait_time=5)
        
        for msg in received_messages:
            print(f"Received: {msg.body.decode('utf-8')}")
            
            # Complete the message so that it is removed from the queue
            receiver.complete_message(msg)
            print("Message completed successfully.")
